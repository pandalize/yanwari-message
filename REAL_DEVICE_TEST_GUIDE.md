# 📱 やんわり伝言アプリ - 実機テスト完全ガイド

## ✅ 実機テスト準備完了（JWT認証版）

このバージョンは **JWT認証システム** を使用しており、Firebase設定の問題がない安定版です。

### 🎯 現在の状況
- **✅ バックエンドサーバー**: ポート8080で稼働中
- **✅ Vue.jsアプリ**: ビルド完了
- **✅ Capacitor**: 同期完了・Xcodeプロジェクト起動済み
- **✅ 認証システム**: JWT認証（Firebase不要）

## 📱 実機テスト手順

### 1. Xcodeでの設定（Xcodeは既に起動済み）

#### 1.1 Development Teamの設定
1. プロジェクトナビゲーターで `App` をクリック
2. `TARGETS` → `App` を選択
3. `Signing & Capabilities` タブ
4. `Team` を自分のApple Developer Accountに設定
5. `Bundle Identifier` を一意の名前に変更（例：`com.yourname.yanwari.message`）

#### 1.2 デバイス設定
1. 実機をUSBケーブルでMacに接続
2. iPhone/iPadで「このコンピュータを信頼しますか？」で「信頼」をタップ
3. Xcodeの上部ツールバーで実機を選択（シミュレーターではなく）

#### 1.3 ビルド・実行
1. Xcode上部の ▶️ ボタンをクリック（または `⌘ + R`）
2. 初回の場合、アプリのビルドに1-2分かかる場合があります

### 2. 初回実行時の追加設定

#### 2.1 「信頼されていない開発者」エラーが出た場合
1. iPhone/iPadの「設定」アプリを開く
2. **一般** → **VPNとデバイス管理** または **プロファイルとデバイス管理**
3. **開発者アプリ** セクションで自分のApple IDを見つける
4. **信頼** をタップ → 確認ダイアログで **信頼** をタップ

#### 2.2 ネットワーク接続の確認
実機からバックエンドAPIにアクセスするため：

1. **Macのローカルネットワークアドレスを確認**:
   ```bash
   ifconfig | grep "inet " | grep -v 127.0.0.1
   ```
   例：`192.168.1.100` などのIPアドレスをメモ

2. **Capacitor設定の更新**（必要に応じて）:
   `frontend/capacitor.config.ts` を編集し、実際のIPアドレスに変更：
   ```typescript
   allowNavigation: [
     'http://192.168.1.100:8080',  // あなたの実際のIPアドレス
     'http://localhost:8080'
   ]
   ```

## 🧪 テストアカウント（JWT認証用）

### テスト用ユーザーアカウント

**🔑 ログインテストアカウント**:
- メールアドレス: `alice@yanwari-message.com`
- パスワード: `password123`

または

- メールアドレス: `bob@yanwari-message.com` 
- パスワード: `password123`

### 新規登録テスト
任意のメールアドレスとパスワード（8文字以上）で新規登録も可能です。

## 🎯 実機テスト項目

### Phase 1: 基本動作確認
- [ ] ✅ **アプリ起動** - スプラッシュスクリーン表示
- [ ] ✅ **ログイン画面** - JWT認証フォーム表示
- [ ] ✅ **ログイン成功** - テストアカウントでログイン
- [ ] ✅ **ホーム画面** - ダッシュボード表示

### Phase 2: メッセージ機能
- [ ] ✅ **メッセージ作成** - 新規メッセージ入力
- [ ] ✅ **受信者選択** - 友達一覧・メールアドレス入力
- [ ] ✅ **AIトーン変換** - 3つのトーン（優しめ・建設的・カジュアル）変換
- [ ] ✅ **トーン選択** - 変換結果から最適なトーンを選択

### Phase 3: スケジュール機能  
- [ ] ✅ **AI時間提案** - メッセージ内容に基づく最適時間提案
- [ ] ✅ **配信時間設定** - 今すぐ・1時間後・明日朝・カスタム時間
- [ ] ✅ **スケジュール一覧** - 送信予定メッセージ確認

### Phase 4: 受信・管理機能
- [ ] ✅ **受信トレイ** - 受信メッセージ一覧表示
- [ ] ✅ **メッセージ評価** - 5段階評価システム
- [ ] ✅ **友達管理** - 友達申請・承諾・一覧管理
- [ ] ✅ **設定画面** - プロフィール・通知・アカウント設定

## 🐛 トラブルシューティング

### 1. アプリが起動しない
**症状**: 白い画面・クラッシュ
**解決方法**:
```bash
# バックエンドサーバー起動確認
lsof -i :8080

# 再ビルド
cd frontend
npm run build
npx cap sync
# Xcodeで再度ビルド実行
```

### 2. ログインができない
**症状**: 「認証に失敗しました」エラー
**確認事項**:
- [ ] バックエンドサーバーが起動中（ポート8080）
- [ ] テストアカウントのメールアドレス・パスワードが正しい
- [ ] 実機がWi-Fi接続されている

### 3. APIエラー・通信できない
**症状**: 「サーバーに接続できません」エラー
**解決方法**:
1. MacとiPhone/iPadが同じWi-Fiネットワークに接続されているか確認
2. Macのファイアウォール設定確認（ポート8080を許可）
3. Capacitor設定の`allowNavigation`に正しいIPアドレスが設定されているか確認

### 4. Xcodeビルドエラー
**症状**: コンパイル・署名エラー
**解決方法**:
```bash
# Podfileの再インストール
cd frontend/ios/App
pod install --repo-update

# Capacitorの再同期
cd ../../
npx cap sync
```

## 📊 パフォーマンス確認項目

### 実機パフォーマンステスト
- [ ] **起動時間**: 3秒以内
- [ ] **画面遷移**: 滑らか（60fps）
- [ ] **AIトーン変換**: 10秒以内
- [ ] **メモリ使用量**: 100MB以下
- [ ] **通信レスポンス**: API呼び出し2秒以内

### UX/UIテスト
- [ ] **各画面サイズ対応**: iPhone・iPad各サイズ
- [ ] **縦・横画面回転**: レスポンシブ対応
- [ ] **タップ・スワイプ**: 自然な操作性
- [ ] **キーボード表示**: 入力フィールド適切表示

## 🎉 テスト完了後

### 成功時の次のステップ
1. **TestFlight配信準備** - Apple Developer Console設定
2. **App Store審査対応** - メタデータ・スクリーンショット準備
3. **本番環境設定** - 本番APIサーバー・データベース設定

### 問題報告時の情報
問題が発生した場合は、以下の情報を報告してください：
- **デバイス情報**: 機種名・iOSバージョン
- **エラーメッセージ**: スクリーンショット
- **再現手順**: 詳細なステップ
- **コンソールログ**: Xcodeのデバッグコンソール内容

---

## 🚀 実機テストを開始

準備が完了しました！以下の手順で実機テストを開始してください：

1. ✅ **Xcode**: 既に起動済み・プロジェクト読み込み完了
2. ✅ **バックエンド**: ポート8080で稼働中
3. ✅ **アプリビルド**: 最新版でビルド・同期完了

**▶️ 次のアクション**: Xcodeの ▶️ ボタンをクリックして実機にアプリをインストール・実行してください！